<div class="card text-white bg-dark mb-3">
    <div class="card-body">
        <h3 class="card-title text-primary">{{ book.title }}</h3>
        
        <button class="btn btn-secondary w-100 mt-2" type="button" data-bs-toggle="collapse" data-bs-target="#bookDetails-{{ book.id }}" aria-expanded="false">
            View More
        </button>

        <div class="collapse mt-3" id="bookDetails-{{ book.id }}">
            <p><strong>Author:</strong> {{ book.author.name }}</p>
            <p><strong>Publisher:</strong> {{ book.publisher }}</p>
            <p><strong>Pages:</strong> {{ book.pages }}</p>
            <p><strong>Subject:</strong> {{ book.get_genre_display }}</p>
            <p><strong>Available Copies:</strong> {{ book.available_copies }}</p>

            <p><strong>Topics:</strong> 
                {% if book.topics %}
                    {{ book.topics }}
                {% else %}
                    <em>No topics listed</em>
                {% endif %}
            </p>
        </div>
        

    
        <hr>

        {% if request.user.is_student %}
        <form action="{% url 'borrow_request' book.id %}" method="post">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary"
                {% if book.available_copies == 0 %}disabled{% endif %}>
                Request to Borrow
            </button>
        </form>
        {% endif %}
        
        {% if request.user.is_admin or request.user.is_librarian %}
            <div class="text-center mb-3">
                <form id="deleteForm-{{ book.id }}" method="POST" action="{% url 'delete_item' 'book' book.id %}">
                    {% csrf_token %}
                    <button type="button" class="btn btn-danger" onclick="confirmDelete('{{ book.id }}')">Delete</button>
                </form>
            </div>
        {% endif %}
        
    </div>
</div>

<script>
    function confirmDelete(bookId) {
        if (confirm("Are you sure you want to delete this book?")) {
            document.getElementById("deleteForm-" + bookId).submit();
        }
    }
</script>




